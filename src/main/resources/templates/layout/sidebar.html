<div th:fragment="sidebar" class="sidebar">

    <!-- ===== HEADER ===== -->
    <div class="sidebar-header">
        <h6 class="sidebar-title">NAVIGASI</h6>

        <div class="sidebar-user" th:if="${session.user != null}">
            <div class="user-avatar"
                 th:text="${#strings.substring(session.user.nama,0,1)}"></div>
            <div class="user-detail">
                <div class="user-name" th:text="${session.user.nama}"></div>
                <div class="user-role" th:text="${session.user.role}"></div>
            </div>
        </div>

        <div class="sidebar-user"
             th:if="${session.user == null and session.role == 'guest'}">
            <div class="user-avatar"
                 th:text="${#strings.substring(session.guestName,0,1)}"></div>
            <div class="user-detail">
                <div class="user-name" th:text="${session.guestName}"></div>
                <div class="user-role">Pengunjung</div>
            </div>
        </div>
    </div>

    <!-- ===== MENU + LOGOUT (SATU SCROLL AREA) ===== -->
    <div class="sidebar-menu">

        <!-- USER INTERNAL -->
        <div th:if="${session.user != null}">
            <a href="/dashboard" class="sidebar-link"
               th:classappend="${activeMenu == 'dashboard'} ? ' active' : ''">
                <i class="bi bi-speedometer2"></i><span>Dashboard</span>
            </a>

            <a href="/konsultasi" class="sidebar-link"
               th:classappend="${activeMenu == 'konsultasi'} ? ' active' : ''">
                <i class="bi bi-clipboard-check"></i><span>Konsultasi</span>
            </a>

            <a href="/riwayat-konsultasi" class="sidebar-link"
               th:classappend="${activeMenu == 'riwayat'} ? ' active' : ''">
                <i class="bi bi-clock-history"></i><span>Riwayat Konsultasi</span>
            </a>

            <!-- ADMIN ONLY -->
            <div th:if="${#strings.equalsIgnoreCase(session.user.role,'admin')}">
                <hr>
                <div class="sidebar-title">ADMIN</div>

                <a href="/gejala" class="sidebar-link">
                    <i class="bi bi-list-task"></i><span>Data Gejala</span>
                </a>
                <a href="/kerusakan" class="sidebar-link">
                    <i class="bi bi-tools"></i><span>Data Kerusakan</span>
                </a>
                <a href="/admin/users" class="sidebar-link">
                    <i class="bi bi-people"></i><span>Kelola User</span>
                </a>
            </div>
        </div>

        <!-- GUEST -->
        <div th:if="${session.user == null and session.role == 'guest'}">
            <a href="/konsultasi" class="sidebar-link">
                <i class="bi bi-clipboard-check"></i><span>Konsultasi</span>
            </a>
        </div>

        <!-- LOGOUT -->
        <hr>
        <a href="/logout" class="sidebar-link logout">
            <i class="bi bi-box-arrow-right"></i>
            <span>Logout</span>
        </a>

    </div>
</div>
